"use strict";(self.webpackChunkdividi_facil_front_end=self.webpackChunkdividi_facil_front_end||[]).push([[410],{1410:(K,d,t)=>{t.r(d),t.d(d,{BalanceUsuarioComponent:()=>x});var _=t(2200),b=t(1413),u=t(6977),U=t(5596),p=t(8834),m=t(1074),D=t(5459),v=t(6850),B=t(9183),E=t(5416),g=t(6471),l=t(2021),f=t(1975),P=t(6627),h=t(9947),M=t(4333),a=t(3664),c=t(8728),O=t(2220),F=t(1782),C=t(9010);function I(e,r){1&e&&(a.qex(0),a.nrm(1,"app-loading-spinner",8),a.bVm())}function T(e,r){1&e&&(a.j41(0,"div",18)(1,"mat-icon"),a.EFF(2,"check_circle"),a.k0s(),a.j41(3,"h3"),a.EFF(4,"\xa1No tienes deudas pendientes!"),a.k0s(),a.j41(5,"p"),a.EFF(6,"Todas tus deudas est\xe1n al d\xeda"),a.k0s()())}function R(e,r){if(1&e&&(a.qex(0),a.EFF(1),a.nI1(2,"currencyFormat"),a.nrm(3,"br"),a.bVm()),2&e){const n=r.$implicit;a.R7$(),a.Lme(" ",n.descripcionGasto," (",a.bMT(2,2,n.montoOriginal),")")}}function j(e,r){if(1&e){const n=a.RV6();a.j41(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon"),a.EFF(4,"receipt"),a.k0s(),a.EFF(5),a.k0s(),a.j41(6,"mat-panel-description")(7,"mat-chip",20),a.EFF(8),a.nI1(9,"currencyFormat"),a.k0s()()(),a.j41(10,"div",21)(11,"div",22)(12,"div",23)(13,"span",12),a.EFF(14,"Acreedor:"),a.k0s(),a.j41(15,"span"),a.EFF(16),a.k0s()(),a.j41(17,"div",23)(18,"span",12),a.EFF(19,"Monto:"),a.k0s(),a.j41(20,"span"),a.EFF(21),a.nI1(22,"currencyFormat"),a.k0s()(),a.j41(23,"div",23)(24,"span",12),a.EFF(25,"Origenes:"),a.k0s(),a.j41(26,"span"),a.DNE(27,R,4,4,"ng-container",24),a.k0s()()(),a.j41(28,"div",25)(29,"button",26),a.bIt("click",function(){const i=c.eBV(n).$implicit,s=a.XpG(4);return c.Njj(s.crearPagoDesdeDeuda(i))}),a.j41(30,"mat-icon"),a.EFF(31,"payment"),a.k0s(),a.EFF(32," Crear Pago "),a.k0s()()()()}if(2&e){const n=r.$implicit;a.R7$(5),a.SpI(" ",n.origenes.length>0?n.origenes[0].descripcionGasto:"Deuda"," "),a.R7$(3),a.SpI(" Debes: ",a.bMT(9,5,n.monto)," "),a.R7$(8),a.JRh(n.nombreUsuarioAcreedor),a.R7$(5),a.JRh(a.bMT(22,7,n.monto)),a.R7$(6),a.Y8G("ngForOf",n.origenes)}}function k(e,r){if(1&e&&(a.j41(0,"div")(1,"mat-accordion"),a.DNE(2,j,33,9,"mat-expansion-panel",19),a.k0s()()),2&e){const n=a.XpG(3);a.R7$(2),a.Y8G("ngForOf",n.balanceUsuario.deudasDetalladas)("ngForTrackBy",n.trackByDeuda)}}function y(e,r){if(1&e&&(a.qex(0),a.j41(1,"div",9)(2,"div",10)(3,"mat-icon"),a.EFF(4,"payment"),a.k0s(),a.j41(5,"div",11)(6,"span",12),a.EFF(7,"Total Pagado"),a.k0s(),a.j41(8,"span",13),a.EFF(9),a.nI1(10,"currencyFormat"),a.k0s()()(),a.j41(11,"div",10)(12,"mat-icon"),a.EFF(13,"account_balance_wallet"),a.k0s(),a.j41(14,"div",11)(15,"span",12),a.EFF(16,"Deber\xeda Haber Pagado"),a.k0s(),a.j41(17,"span",14),a.EFF(18),a.nI1(19,"currencyFormat"),a.k0s()()(),a.j41(20,"div",10)(21,"mat-icon"),a.EFF(22," account_balance "),a.k0s(),a.j41(23,"div",11)(24,"span",12),a.EFF(25,"Balance Final"),a.k0s(),a.j41(26,"span",14),a.EFF(27),a.nI1(28,"currencyFormat"),a.k0s()()()(),a.j41(29,"div",15),a.DNE(30,T,7,0,"div",16)(31,k,3,2,"div",17),a.k0s(),a.bVm()),2&e){const n=a.XpG(2);a.R7$(9),a.JRh(a.bMT(10,9,n.balanceUsuario.totalPagado)),a.R7$(9),a.JRh(a.bMT(19,11,n.balanceUsuario.deberiaHaberPagado)),a.R7$(3),a.HbH("balance-"+n.obtenerColorBalance(n.balanceUsuario.balance)),a.R7$(5),a.HbH("balance-"+n.obtenerColorBalance(n.balanceUsuario.balance)),a.R7$(),a.SpI(" ",a.bMT(28,13,n.balanceUsuario.balance)," "),a.R7$(3),a.Y8G("ngIf",!n.balanceUsuario.deudasDetalladas||0===n.balanceUsuario.deudasDetalladas.length),a.R7$(),a.Y8G("ngIf",n.balanceUsuario.deudasDetalladas&&n.balanceUsuario.deudasDetalladas.length>0)}}function A(e,r){1&e&&(a.j41(0,"div",27)(1,"mat-icon"),a.EFF(2,"account_balance_wallet"),a.k0s(),a.j41(3,"h2"),a.EFF(4,"No hay datos de balance personal"),a.k0s()())}function $(e,r){if(1&e&&a.DNE(0,y,32,15,"ng-container",7)(1,A,5,0,"ng-template",null,1,a.C5r),2&e){const n=a.sdS(2),o=a.XpG();a.Y8G("ngIf",o.balanceUsuario)("ngIfElse",n)}}let x=(()=>{class e{balanceService;route;router;snackBar;destroy$=new b.B;loading=!1;balanceUsuario=null;balanceUsuarios=[];idUsuario="";idGrupo="";displayedColumnsDeudas=["gasto","fecha","monto","corresponde","pagado","pendiente","acciones"];constructor(n,o,i,s){this.balanceService=n,this.route=o,this.router=i,this.snackBar=s}ngOnInit(){this.route.params.pipe((0,u.Q)(this.destroy$)).subscribe(n=>{this.idUsuario=n.id,this.idGrupo=this.route.snapshot.queryParams.idGrupo,this.idUsuario&&this.idGrupo&&this.cargarBalanceUsuario()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarBalanceUsuario(){this.loading=!0,this.balanceService.obtenerBalanceUsuario(this.idUsuario).pipe((0,u.Q)(this.destroy$)).subscribe({next:n=>{this.loading=!1,n.exito&&n.data&&Array.isArray(n.data)?(this.balanceUsuarios=n.data,this.balanceUsuario=n.data.find(o=>o.idUsuario===this.idUsuario)||null):this.snackBar.open("Error al cargar balance del usuario","Cerrar",{duration:3e3})},error:n=>{this.loading=!1,console.error("Error al cargar balance:",n),this.snackBar.open("Error al cargar balance del usuario","Cerrar",{duration:3e3})}})}crearPagoDesdeDeuda(n){this.router.navigate(["/alta-pagos"],{queryParams:{idGrupo:this.idGrupo,monto:n.monto,concepto:"Pago de deuda"}})}volverAlBalanceGrupo(){this.router.navigate(["/balances/grupo",this.idGrupo])}obtenerColorBalance(n){return n>0?"primary":n<0?"warn":"accent"}obtenerEstadoBalance(n){return n>0?"A favor":n<0?"En deuda":"Equilibrado"}trackByDeuda(n,o){return`${o.idUsuarioDeudor}-${o.idUsuarioAcreedor}`}static \u0275fac=function(o){return new(o||e)(a.rXU(O.o),a.rXU(F.nX),a.rXU(F.Ix),a.rXU(E.UG))};static \u0275cmp=a.VBU({type:e,selectors:[["app-balance-usuario"]],decls:18,vars:3,consts:[["balanceUsuarioContent",""],["emptyState",""],[1,"balance-usuario-container"],["card-header",""],["mat-icon-button","",1,"back-button",3,"click"],["mat-button","",3,"click","disabled"],["card-content",""],[4,"ngIf","ngIfElse"],["text","Cargando balance personal..."],[1,"balance-overview"],[1,"balance-stat"],[1,"stat-info"],[1,"label"],[1,"value","pagado"],[1,"value"],[1,"detalles-deudas"],["class","empty-tab",4,"ngIf"],[4,"ngIf"],[1,"empty-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],["color","warn"],[1,"deuda-detalle"],[1,"deuda-info"],[1,"info-row"],[4,"ngFor","ngForOf"],[1,"deuda-acciones"],["mat-raised-button","","color","primary",3,"click"],[1,"empty-state"]],template:function(o,i){if(1&o){const s=a.RV6();a.j41(0,"div",2)(1,"app-card"),a.qex(2,3),a.j41(3,"button",4),a.bIt("click",function(){return c.eBV(s),c.Njj(i.volverAlBalanceGrupo())}),a.j41(4,"mat-icon"),a.EFF(5,"arrow_back"),a.k0s()(),a.j41(6,"mat-icon"),a.EFF(7,"person"),a.k0s(),a.j41(8,"span"),a.EFF(9,"Balance Personal"),a.k0s(),a.j41(10,"button",5),a.bIt("click",function(){return c.eBV(s),c.Njj(i.cargarBalanceUsuario())}),a.j41(11,"mat-icon"),a.EFF(12,"refresh"),a.k0s(),a.EFF(13," Actualizar "),a.k0s(),a.bVm(),a.qex(14,6),a.DNE(15,I,2,0,"ng-container",7)(16,$,3,2,"ng-template",null,0,a.C5r),a.bVm(),a.k0s()()}if(2&o){const s=a.sdS(17);a.R7$(10),a.Y8G("disabled",i.loading),a.R7$(5),a.Y8G("ngIf",i.loading)("ngIfElse",s)}},dependencies:[_.MD,_.Sq,_.bT,U.Hu,p.Hl,p.$z,C.M,m.m_,m.An,D.tP,v.RI,B.D6,E._T,g.YN,g.Jl,l.MY,l.BS,l.GK,l.Z2,l.WN,l.Q6,f.Y,P.l,h.i,M.N],encapsulation:2})}return e})()}}]);