"use strict";(self.webpackChunkdividi_facil_front_end=self.webpackChunkdividi_facil_front_end||[]).push([[841],{8841:(Be,S,a)=>{a.r(S),a.d(S,{AltaPagosComponent:()=>Ne});var O=a(2200),u=a(9417),C=a(1413),b=a(6977),_=a(5596),E=a(8834),T=a(1074),x=a(3746),k=a(3791),W=a(9183),R=a(5416),y=a(3496),e=a(3664),s=a(8728),G=(a(7705),a(3980)),f=a(4500);a(5178),a(9629),a(8359),a(7786),a(7673),a(9030),a(1985),a(6609),a(372),a(7336),a(7035),a(7870),a(9327),a(6939),a(1959),a(5964),a(6354),a(9172),a(5558),a(8141),a(3236),a(8793),a(6697),a(9974),a(4360),a(5343),a(3703),a(1397),a(8750),a(1584);var g=a(5404),B=a(9214),Y=a(1715);const _e={provide:new s.nKC("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{const i=(0,s.WQX)(s.zZn);return()=>(0,f.o)(i)}}),deps:[],useFactory:function fe(i){const l=(0,s.WQX)(s.zZn);return()=>(0,f.o)(l)}};let be=(()=>{class i{static \u0275fac=function(o){return new(o||i)};static \u0275mod=e.$C({type:i});static \u0275inj=s.G2t({providers:[_e],imports:[f.t,B.M,Y.M,G.Gj,B.M,Y.M]})}return i})();var ye=a(9947),Oe=a(4333),Ce=a(6437),Ae=a(3817),Pe=a(7545),U=a(1782),Fe=a(9010);function Me(i,l){1&i&&(e.qex(0),e.nrm(1,"app-loading-spinner",9),e.bVm())}function Se(i,l){if(1&i&&(e.j41(0,"mat-option",34),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.idGrupo),e.R7$(),e.SpI(" ",t.nombreGrupo," ")}}function Ee(i,l){1&i&&(e.j41(0,"mat-error"),e.EFF(1," Debes seleccionar un grupo "),e.k0s())}function Te(i,l){if(1&i&&(e.j41(0,"mat-option",34),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.idUsuario),e.R7$(),e.SpI(" ",t.nombre," ")}}function xe(i,l){1&i&&(e.j41(0,"mat-hint"),e.EFF(1,"Selecciona un grupo primero"),e.k0s())}function ke(i,l){1&i&&(e.j41(0,"mat-error",35),e.EFF(1," Debes seleccionar a qui\xe9n pagarle "),e.k0s())}function Re(i,l){1&i&&(e.j41(0,"mat-error",36),e.EFF(1," El monto es requerido "),e.k0s())}function Ie(i,l){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El monto debe ser mayor a 0 "),e.k0s())}function Ge(i,l){1&i&&(e.j41(0,"mat-error",37),e.EFF(1," El concepto es requerido "),e.k0s())}function De(i,l){1&i&&(e.j41(0,"mat-error"),e.EFF(1," El concepto debe tener al menos 3 caracteres "),e.k0s())}function je(i,l){if(1&i&&(e.j41(0,"mat-card",38)(1,"mat-card-header")(2,"mat-card-title")(3,"mat-icon"),e.EFF(4,"summarize"),e.k0s(),e.EFF(5," Resumen del Pago "),e.k0s()(),e.j41(6,"mat-card-content")(7,"div",39)(8,"div",40)(9,"span",41),e.EFF(10,"Grupo:"),e.k0s(),e.j41(11,"span",42),e.EFF(12),e.k0s()(),e.j41(13,"div",40)(14,"span",41),e.EFF(15,"Receptor:"),e.k0s(),e.j41(16,"span",42),e.EFF(17),e.k0s()(),e.j41(18,"div",40)(19,"span",41),e.EFF(20,"Monto:"),e.k0s(),e.j41(21,"span",43),e.EFF(22),e.k0s()()()()()),2&i){let t,o,n;const r=e.XpG(2);e.R7$(12),e.JRh(r.obtenerNombreGrupo(null==(t=r.pagoForm.get("idGrupo"))?null:t.value)),e.R7$(5),e.JRh(r.obtenerNombreMiembro(null==(o=r.pagoForm.get("idReceptor"))?null:o.value)),e.R7$(5),e.SpI("$",(null==(n=r.pagoForm.get("monto"))?null:n.value)||"0.00")}}function Le(i,l){1&i&&(e.j41(0,"mat-icon"),e.EFF(1,"save"),e.k0s())}function we(i,l){1&i&&(e.j41(0,"mat-icon",44),e.EFF(1,"hourglass_empty"),e.k0s())}function Ve(i,l){if(1&i){const t=e.RV6();e.j41(0,"form",10),e.bIt("ngSubmit",function(){s.eBV(t);const n=e.XpG();return s.Njj(n.crearPago())}),e.j41(1,"div",11)(2,"mat-icon"),e.EFF(3,"group"),e.k0s(),e.j41(4,"span"),e.EFF(5,"Informaci\xf3n del Grupo"),e.k0s(),e.j41(6,"mat-form-field",12)(7,"mat-label"),e.EFF(8,"Seleccionar Grupo"),e.k0s(),e.j41(9,"mat-select",13),e.bIt("selectionChange",function(){s.eBV(t);const n=e.XpG();return s.Njj(n.onGrupoSeleccionado())}),e.DNE(10,Se,2,2,"mat-option",14),e.k0s(),e.j41(11,"mat-icon",15),e.EFF(12,"group"),e.k0s(),e.DNE(13,Ee,2,0,"mat-error",16),e.k0s()(),e.j41(14,"div",11)(15,"mat-icon"),e.EFF(16,"payment"),e.k0s(),e.j41(17,"span"),e.EFF(18,"Detalles del Pago"),e.k0s(),e.j41(19,"div",17)(20,"mat-form-field",12)(21,"mat-label",18),e.EFF(22,"Pagar a"),e.k0s(),e.j41(23,"mat-select",19),e.DNE(24,Te,2,2,"mat-option",14),e.k0s(),e.j41(25,"mat-icon",15),e.EFF(26,"person"),e.k0s(),e.DNE(27,xe,2,0,"mat-hint",16)(28,ke,2,0,"mat-error",20),e.k0s(),e.j41(29,"mat-form-field",12)(30,"mat-label",21),e.EFF(31,"Monto"),e.k0s(),e.nrm(32,"input",22),e.j41(33,"span",23),e.EFF(34,"$\xa0"),e.k0s(),e.j41(35,"mat-icon",15),e.EFF(36,"attach_money"),e.k0s(),e.DNE(37,Re,2,0,"mat-error",24)(38,Ie,2,0,"mat-error",16),e.k0s(),e.j41(39,"mat-form-field",12)(40,"mat-label",25),e.EFF(41,"Concepto del pago"),e.k0s(),e.nrm(42,"textarea",26),e.j41(43,"mat-icon",15),e.EFF(44,"description"),e.k0s(),e.DNE(45,Ge,2,0,"mat-error",27)(46,De,2,0,"mat-error",16),e.k0s()()(),e.DNE(47,je,23,3,"mat-card",28),e.j41(48,"div",29)(49,"div",30)(50,"button",31),e.bIt("click",function(){s.eBV(t);const n=e.XpG();return s.Njj(n.cancelar())}),e.j41(51,"mat-icon"),e.EFF(52,"close"),e.k0s(),e.EFF(53," Cancelar "),e.k0s(),e.j41(54,"button",32),e.DNE(55,Le,2,0,"mat-icon",16)(56,we,2,0,"mat-icon",33),e.EFF(57),e.k0s()()()()}if(2&i){let t,o,n,r,c,d,m;const p=e.XpG();e.Y8G("formGroup",p.pagoForm),e.R7$(10),e.Y8G("ngForOf",p.gruposDisponibles),e.R7$(3),e.Y8G("ngIf",null==(t=p.pagoForm.get("idGrupo"))?null:t.hasError("required")),e.R7$(10),e.Y8G("disabled",0===p.miembrosGrupo.length),e.R7$(),e.Y8G("ngForOf",p.miembrosGrupo),e.R7$(3),e.Y8G("ngIf",0===p.miembrosGrupo.length),e.R7$(),e.Y8G("ngIf",null==(o=p.pagoForm.get("idReceptor"))?null:o.hasError("required")),e.R7$(9),e.Y8G("ngIf",null==(n=p.pagoForm.get("monto"))?null:n.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(r=p.pagoForm.get("monto"))?null:r.hasError("min")),e.R7$(7),e.Y8G("ngIf",null==(c=p.pagoForm.get("concepto"))?null:c.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(d=p.pagoForm.get("concepto"))?null:d.hasError("minlength")),e.R7$(),e.Y8G("ngIf",(null==(m=p.pagoForm.get("idGrupo"))?null:m.value)&&(null==(m=p.pagoForm.get("idReceptor"))?null:m.value)),e.R7$(3),e.Y8G("disabled",p.guardando),e.R7$(4),e.Y8G("disabled",!p.pagoForm.valid||p.guardando),e.R7$(),e.Y8G("ngIf",!p.guardando),e.R7$(),e.Y8G("ngIf",p.guardando),e.R7$(),e.SpI(" ",p.guardando?"Creando Pago...":"Crear Pago"," ")}}let Ne=(()=>{class i{fb;pagoService;grupoService;authService;router;route;snackBar;destroy$=new C.B;loading=!1;guardando=!1;pagoForm;gruposDisponibles=[];miembrosGrupo=[];usuarioActual;idGrupoPreseleccionado="";constructor(t,o,n,r,c,d,m){this.fb=t,this.pagoService=o,this.grupoService=n,this.authService=r,this.router=c,this.route=d,this.snackBar=m,this.pagoForm=this.fb.group({idGrupo:["",u.k0.required],idReceptor:["",u.k0.required],monto:["",[u.k0.required,u.k0.min(.01)]],concepto:["",[u.k0.required,u.k0.minLength(3)]]})}ngOnInit(){this.usuarioActual=this.authService.obtenerUsuario(),this.route.queryParams.pipe((0,b.Q)(this.destroy$)).subscribe(t=>{this.idGrupoPreseleccionado=t.idGrupo||"",this.cargarGrupos()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarGrupos(){this.loading=!0,this.grupoService.getGrupos().pipe((0,b.Q)(this.destroy$)).subscribe({next:t=>{this.loading=!1,t.exito&&t.data&&(this.gruposDisponibles=t.data,this.idGrupoPreseleccionado&&(this.pagoForm.patchValue({idGrupo:this.idGrupoPreseleccionado}),this.onGrupoSeleccionado()))},error:t=>{this.loading=!1,console.error("Error al cargar grupos:",t),this.snackBar.open("Error al cargar grupos","Cerrar",{duration:3e3})}})}onGrupoSeleccionado(){const t=this.pagoForm.get("idGrupo")?.value;t?this.grupoService.obtenerMiembros(t).pipe((0,b.Q)(this.destroy$)).subscribe({next:o=>{o.exito&&o.data&&(this.miembrosGrupo=(o.data.miembros||[]).filter(n=>n.idUsuario!==this.usuarioActual?.idUsuario))},error:o=>{console.error("Error al cargar miembros:",o),this.snackBar.open("Error al cargar miembros del grupo","Cerrar",{duration:3e3})}}):this.miembrosGrupo=[]}crearPago(){if(!this.pagoForm.valid)return;this.guardando=!0;const t={idGrupo:this.pagoForm.get("idGrupo")?.value,idReceptor:this.pagoForm.get("idReceptor")?.value,monto:Number(this.pagoForm.get("monto")?.value),concepto:this.pagoForm.get("concepto")?.value};this.pagoService.crearPago(t).pipe((0,b.Q)(this.destroy$)).subscribe({next:o=>{this.guardando=!1,o.exito?(this.snackBar.open("\xa1Pago creado exitosamente!","Cerrar",{duration:3e3,panelClass:["success-snackbar"]}),this.router.navigate(["/listado-pagos"],{queryParams:{idGrupo:t.idGrupo}})):this.snackBar.open("Error al crear pago","Cerrar",{duration:3e3})},error:o=>{this.guardando=!1,console.error("Error al crear pago:",o),this.snackBar.open("Error al crear pago","Cerrar",{duration:3e3})}})}cancelar(){this.idGrupoPreseleccionado?this.router.navigate(["/listado-pagos"],{queryParams:{idGrupo:this.idGrupoPreseleccionado}}):this.router.navigate(["/listado-pagos"])}obtenerNombreGrupo(t){return this.gruposDisponibles.find(n=>n.idGrupo===t)?.nombreGrupo||""}obtenerNombreMiembro(t){return this.miembrosGrupo.find(n=>n.idUsuario===t)?.nombre||""}static \u0275fac=function(o){return new(o||i)(e.rXU(u.ok),e.rXU(Ce.f),e.rXU(Ae.b),e.rXU(Pe.u),e.rXU(U.Ix),e.rXU(U.nX),e.rXU(R.UG))};static \u0275cmp=e.VBU({type:i,selectors:[["app-alta-pagos"]],decls:20,vars:2,consts:[["altaPagoForm",""],[1,"alta-container"],[1,"header-section"],["mat-icon-button","",1,"back-button",3,"click"],["id","main-title"],["card-header",""],["id","card-title",1,"card-title"],["card-content",""],[4,"ngIf","ngIfElse"],["text","Cargando grupos..."],[3,"ngSubmit","formGroup"],[1,"form-card"],["appearance","outline",1,"full-width"],["formControlName","idGrupo",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matSuffix",""],[4,"ngIf"],[1,"form-grid"],["id","label-receptor"],["formControlName","idReceptor","aria-labelledby","label-receptor","aria-describedby","error-receptor",3,"disabled"],["id","error-receptor",4,"ngIf"],["id","label-monto"],["matInput","","type","number","step","0.01","min","0","formControlName","monto","placeholder","0.00","aria-labelledby","label-monto","aria-describedby","error-monto"],["matTextPrefix",""],["id","error-monto",4,"ngIf"],["id","label-concepto"],["matInput","","rows","3","formControlName","concepto","placeholder","Ej: Pago por cena del viernes","aria-labelledby","label-concepto","aria-describedby","error-concepto"],["id","error-concepto",4,"ngIf"],["class","resumen-card",4,"ngIf"],[1,"acciones-card"],[1,"acciones-grid"],["type","button","mat-button","",3,"click","disabled"],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["class","spinning",4,"ngIf"],[3,"value"],["id","error-receptor"],["id","error-monto"],["id","error-concepto"],[1,"resumen-card"],[1,"resumen-grid"],[1,"resumen-item"],[1,"label"],[1,"value"],[1,"value","monto"],[1,"spinning"]],template:function(o,n){if(1&o){const r=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"button",3),e.bIt("click",function(){return s.eBV(r),s.Njj(n.cancelar())}),e.j41(3,"mat-icon"),e.EFF(4,"arrow_back"),e.k0s()(),e.j41(5,"h1",4)(6,"mat-icon"),e.EFF(7,"add_circle"),e.k0s(),e.EFF(8," Crear Nuevo Pago "),e.k0s()(),e.j41(9,"app-card"),e.qex(10,5),e.j41(11,"mat-icon"),e.EFF(12,"add_circle"),e.k0s(),e.j41(13,"span")(14,"h2",6),e.EFF(15,"Crear Nuevo Pago"),e.k0s()(),e.bVm(),e.qex(16,7),e.DNE(17,Me,2,0,"ng-container",8)(18,Ve,58,17,"ng-template",null,0,e.C5r),e.bVm(),e.k0s()()}if(2&o){const r=e.sdS(19);e.R7$(17),e.Y8G("ngIf",n.loading)("ngIfElse",r)}},dependencies:[O.MD,O.Sq,O.bT,u.X1,u.qT,u.me,u.Q0,u.BC,u.cb,u.VZ,u.j4,u.JD,_.Hu,_.RN,_.m2,_.MM,_.dh,E.Hl,E.$z,Fe.M,T.m_,T.An,x.fS,x.fg,g.j,g.M,g.c,g.b,g.e,g.g,k.M,k.g,y.M,W.D6,R._T,be,ye.i,Oe.N],styles:['@charset "UTF-8";.alta-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1rem}.header-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:2rem}.header-section[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{color:#666}.header-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#333;display:flex;align-items:center;gap:.5rem}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:1rem;padding:3rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin:0}.form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-card[_ngcontent-%COMP%]   .form-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.form-card[_ngcontent-%COMP%]   .form-grid[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.resumen-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e3f2fd,#f3e5f5)}.resumen-card[_ngcontent-%COMP%]   .resumen-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.resumen-card[_ngcontent-%COMP%]   .resumen-grid[_ngcontent-%COMP%]   .resumen-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#ffffffb3;border-radius:8px}.resumen-card[_ngcontent-%COMP%]   .resumen-grid[_ngcontent-%COMP%]   .resumen-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.resumen-card[_ngcontent-%COMP%]   .resumen-grid[_ngcontent-%COMP%]   .resumen-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#333}.resumen-card[_ngcontent-%COMP%]   .resumen-grid[_ngcontent-%COMP%]   .resumen-item[_ngcontent-%COMP%]   .value.monto[_ngcontent-%COMP%]{color:#2e7d32;font-size:1.1rem}.acciones-card[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end}.acciones-card[_ngcontent-%COMP%]   .acciones-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:140px;height:48px;display:flex;align-items:center;justify-content:center;gap:.5rem}.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.alta-container[_ngcontent-%COMP%]{padding:.5rem}.acciones-grid[_ngcontent-%COMP%]{flex-direction:column}.acciones-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.resumen-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.5rem}}[_nghost-%COMP%]{contain:layout style paint;display:block}.dashboard-container[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%], .actions-grid[_ngcontent-%COMP%], .timeline-list[_ngcontent-%COMP%]{transform:translateZ(0);will-change:transform}mat-card[_ngcontent-%COMP%]{backface-visibility:hidden}.dashboard-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}']})}return i})()}}]);