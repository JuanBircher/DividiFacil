"use strict";(self.webpackChunkdividi_facil_front_end=self.webpackChunkdividi_facil_front_end||[]).push([[251],{1251:($,l,o)=>{o.r(l),o.d(l,{DetallePagosComponent:()=>A});var p=o(2200),F=o(1413),d=o(6977),c=o(5596),g=o(8834),m=o(1074),h=o(6471),v=o(9183),E=o(5416),u=o(1997),C=o(8776),D=o(6627),M=o(9947),R=o(4333),a=o(3664),i=o(8728),O=o(6437),k=o(7545),f=o(1782),I=o(9010);function j(e,s){1&e&&(a.qex(0),a.nrm(1,"app-loading-spinner",6),a.bVm())}function b(e,s){if(1&e&&(a.j41(0,"div",31)(1,"mat-icon",38),a.EFF(2,"check_circle"),a.k0s(),a.j41(3,"div",33)(4,"span",34),a.EFF(5,"Pago confirmado"),a.k0s(),a.j41(6,"span",35),a.EFF(7),a.nI1(8,"dateFormat"),a.k0s()()()),2&e){const t=a.XpG(3);a.R7$(7),a.JRh(a.bMT(8,1,t.pago.fechaConfirmacion))}}function T(e,s){if(1&e){const t=a.RV6();a.j41(0,"div",42)(1,"button",43),a.bIt("click",function(){i.eBV(t);const r=a.XpG(4);return i.Njj(r.rechazarPago())}),a.j41(2,"mat-icon"),a.EFF(3,"cancel"),a.k0s(),a.EFF(4," Rechazar "),a.k0s(),a.j41(5,"button",44),a.bIt("click",function(){i.eBV(t);const r=a.XpG(4);return i.Njj(r.confirmarPago())}),a.j41(6,"mat-icon"),a.EFF(7,"check_circle"),a.k0s(),a.EFF(8," Confirmar Pago "),a.k0s()()}if(2&e){const t=a.XpG(4);a.R7$(),a.Y8G("disabled",t.procesando),a.R7$(4),a.Y8G("disabled",t.procesando)}}function B(e,s){if(1&e&&(a.j41(0,"mat-card",39)(1,"mat-card-content")(2,"div",40)(3,"mat-icon"),a.EFF(4,"info"),a.k0s(),a.j41(5,"span"),a.EFF(6,"Este pago est\xe1 pendiente de confirmaci\xf3n"),a.k0s()(),a.DNE(7,T,9,2,"div",41),a.k0s()()),2&e){const t=a.XpG(3);a.R7$(7),a.Y8G("ngIf",t.puedeConfirmar()||t.puedeRechazar())}}function U(e,s){if(1&e&&(a.qex(0),a.j41(1,"div",8)(2,"div",9)(3,"mat-chip",10)(4,"mat-icon"),a.EFF(5),a.k0s(),a.EFF(6),a.k0s()(),a.j41(7,"div",11)(8,"span",12),a.EFF(9,"Monto"),a.k0s(),a.j41(10,"span",13),a.EFF(11),a.nI1(12,"currencyFormat"),a.k0s()()(),a.nrm(13,"mat-divider"),a.j41(14,"div",14)(15,"h2"),a.EFF(16),a.k0s(),a.j41(17,"p",15)(18,"mat-icon"),a.EFF(19,"schedule"),a.k0s(),a.EFF(20),a.nI1(21,"dateFormat"),a.k0s()(),a.j41(22,"div",16)(23,"mat-card",17)(24,"mat-card-header")(25,"mat-card-title")(26,"mat-icon"),a.EFF(27,"group"),a.k0s(),a.EFF(28," Informaci\xf3n del Grupo "),a.k0s()(),a.j41(29,"mat-card-content")(30,"div",18)(31,"span",19),a.EFF(32,"Grupo:"),a.k0s(),a.j41(33,"span",20),a.EFF(34),a.k0s()()()(),a.j41(35,"mat-card",17)(36,"mat-card-header")(37,"mat-card-title")(38,"mat-icon"),a.EFF(39,"people"),a.k0s(),a.EFF(40," Participantes "),a.k0s()(),a.j41(41,"mat-card-content")(42,"div",21)(43,"div",22)(44,"div",23)(45,"mat-icon"),a.EFF(46,"person"),a.k0s(),a.j41(47,"div",24)(48,"span",25),a.EFF(49),a.k0s(),a.j41(50,"span",26),a.EFF(51,"Pagador"),a.k0s()()()(),a.j41(52,"div",27)(53,"mat-icon"),a.EFF(54,"arrow_forward"),a.k0s()(),a.j41(55,"div",28)(56,"div",23)(57,"mat-icon"),a.EFF(58,"person"),a.k0s(),a.j41(59,"div",24)(60,"span",25),a.EFF(61),a.k0s(),a.j41(62,"span",26),a.EFF(63,"Receptor"),a.k0s()()()()()()()(),a.j41(64,"mat-card",29)(65,"mat-card-header")(66,"mat-card-title")(67,"mat-icon"),a.EFF(68,"event"),a.k0s(),a.EFF(69," Historial de Fechas "),a.k0s()(),a.j41(70,"mat-card-content")(71,"div",30)(72,"div",31)(73,"mat-icon",32),a.EFF(74,"add_circle"),a.k0s(),a.j41(75,"div",33)(76,"span",34),a.EFF(77,"Pago creado"),a.k0s(),a.j41(78,"span",35),a.EFF(79),a.nI1(80,"dateFormat"),a.k0s()()(),a.DNE(81,b,9,3,"div",36),a.k0s()()(),a.DNE(82,B,8,1,"mat-card",37),a.bVm()),2&e){const t=a.XpG(2);a.R7$(3),a.Y8G("color",t.obtenerColorEstado(t.pago.estado)),a.R7$(2),a.JRh(t.obtenerIconoEstado(t.pago.estado)),a.R7$(),a.SpI(" ",t.pago.estado," "),a.R7$(5),a.JRh(a.bMT(12,12,t.pago.monto)),a.R7$(5),a.JRh(t.pago.concepto),a.R7$(4),a.SpI(" Creado el ",a.bMT(21,14,t.pago.fechaCreacion)," "),a.R7$(14),a.JRh(t.pago.nombreGrupo),a.R7$(15),a.JRh(t.pago.nombrePagador),a.R7$(12),a.JRh(t.pago.nombreReceptor),a.R7$(18),a.JRh(a.bMT(80,16,t.pago.fechaCreacion)),a.R7$(2),a.Y8G("ngIf",t.pago.fechaConfirmacion),a.R7$(),a.Y8G("ngIf","Pendiente"===t.pago.estado)}}function x(e,s){if(1&e&&a.DNE(0,U,83,18,"ng-container",7),2&e){const t=a.XpG();a.Y8G("ngIf",t.pago)}}let A=(()=>{class e{pagoService;authService;router;route;snackBar;destroy$=new F.B;loading=!1;procesando=!1;pago=null;idPago="";usuarioActual;constructor(t,n,r,_,P){this.pagoService=t,this.authService=n,this.router=r,this.route=_,this.snackBar=P}ngOnInit(){this.usuarioActual=this.authService.obtenerUsuario(),this.route.params.pipe((0,d.Q)(this.destroy$)).subscribe(t=>{this.idPago=t.id,this.idPago&&this.cargarPago()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarPago(){this.loading=!0,this.pagoService.obtenerPago(this.idPago).pipe((0,d.Q)(this.destroy$)).subscribe({next:t=>{this.loading=!1,t.exito&&t.data?this.pago=t.data:(this.snackBar.open("Pago no encontrado","Cerrar",{duration:3e3}),this.volver())},error:t=>{this.loading=!1,console.error("Error al cargar pago:",t),this.snackBar.open("Error al cargar pago","Cerrar",{duration:3e3}),this.volver()}})}confirmarPago(){!this.pago||!this.puedeConfirmar()||(this.procesando=!0,this.pagoService.confirmarPago(this.pago.idPago).pipe((0,d.Q)(this.destroy$)).subscribe({next:t=>{this.procesando=!1,t.exito&&(this.snackBar.open("\xa1Pago confirmado exitosamente!","Cerrar",{duration:3e3,panelClass:["success-snackbar"]}),this.cargarPago())},error:t=>{this.procesando=!1,console.error("Error al confirmar pago:",t),this.snackBar.open("Error al confirmar pago","Cerrar",{duration:3e3})}}))}rechazarPago(){if(!this.pago||!this.puedeRechazar())return;const t=prompt("\xbfPor qu\xe9 rechazas este pago? (Opcional):");this.procesando=!0,this.pagoService.rechazarPago(this.pago.idPago,t||void 0).pipe((0,d.Q)(this.destroy$)).subscribe({next:n=>{this.procesando=!1,n.exito&&(this.snackBar.open("Pago rechazado","Cerrar",{duration:3e3}),this.cargarPago())},error:n=>{this.procesando=!1,console.error("Error al rechazar pago:",n),this.snackBar.open("Error al rechazar pago","Cerrar",{duration:3e3})}})}volver(){this.router.navigate(["/pagos"])}puedeConfirmar(){return"Pendiente"===this.pago?.estado&&this.pago?.idReceptor===this.usuarioActual?.idUsuario}puedeRechazar(){return"Pendiente"===this.pago?.estado&&this.pago?.idReceptor===this.usuarioActual?.idUsuario}obtenerColorEstado(t){return{Pendiente:"warn",Completado:"primary",Rechazado:"accent"}[t]||"primary"}obtenerIconoEstado(t){return{Pendiente:"schedule",Completado:"check_circle",Rechazado:"cancel"}[t]||"help"}static \u0275fac=function(n){return new(n||e)(a.rXU(O.f),a.rXU(k.u),a.rXU(f.Ix),a.rXU(f.nX),a.rXU(E.UG))};static \u0275cmp=a.VBU({type:e,selectors:[["app-detalle-pagos"]],decls:14,vars:2,consts:[["detallePagoContent",""],[1,"detalle-container"],["card-header",""],["mat-icon-button","",1,"back-button",3,"click"],["card-content",""],[4,"ngIf","ngIfElse"],["text","Cargando detalle del pago..."],[4,"ngIf"],[1,"info-header"],[1,"estado-section"],[1,"estado-chip",3,"color"],[1,"monto-section"],[1,"monto-label"],[1,"monto-valor"],[1,"concepto-section"],[1,"fecha-creacion"],[1,"detalle-grid"],[1,"detalle-card"],[1,"info-item"],[1,"label"],[1,"value"],[1,"participantes-grid"],[1,"participante-item","pagador"],[1,"participante-info"],[1,"participante-details"],[1,"nombre"],[1,"rol"],[1,"arrow-container"],[1,"participante-item","receptor"],[1,"fechas-card"],[1,"fechas-timeline"],[1,"fecha-item"],[1,"fecha-icon"],[1,"fecha-content"],[1,"fecha-label"],[1,"fecha-valor"],["class","fecha-item",4,"ngIf"],["class","acciones-card",4,"ngIf"],[1,"fecha-icon","confirmado"],[1,"acciones-card"],[1,"acciones-info"],["class","acciones-buttons",4,"ngIf"],[1,"acciones-buttons"],["mat-button","","color","warn",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"]],template:function(n,r){if(1&n){const _=a.RV6();a.j41(0,"div",1)(1,"app-card"),a.qex(2,2),a.j41(3,"button",3),a.bIt("click",function(){return i.eBV(_),i.Njj(r.volver())}),a.j41(4,"mat-icon"),a.EFF(5,"arrow_back"),a.k0s()(),a.j41(6,"mat-icon"),a.EFF(7,"payment"),a.k0s(),a.j41(8,"span"),a.EFF(9,"Detalle del Pago"),a.k0s(),a.bVm(),a.qex(10,4),a.DNE(11,j,2,0,"ng-container",5)(12,x,1,1,"ng-template",null,0,a.C5r),a.bVm(),a.k0s()()}if(2&n){const _=a.sdS(13);a.R7$(11),a.Y8G("ngIf",r.loading)("ngIfElse",_)}},dependencies:[p.MD,p.bT,c.Hu,c.RN,c.m2,c.MM,c.dh,g.Hl,g.$z,I.M,m.m_,m.An,h.YN,h.Jl,v.D6,E._T,u.w,u.q,C.a,D.l,M.i,R.N],styles:['@charset "UTF-8";[_nghost-%COMP%]{contain:layout style paint;display:block}.dashboard-container[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%], .actions-grid[_ngcontent-%COMP%], .timeline-list[_ngcontent-%COMP%]{transform:translateZ(0);will-change:transform}mat-card[_ngcontent-%COMP%]{backface-visibility:hidden}.dashboard-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}']})}return e})()}}]);