"use strict";(self.webpackChunkdividi_facil_front_end=self.webpackChunkdividi_facil_front_end||[]).push([[85],{9085:(x,p,o)=>{o.r(p),o.d(p,{AltaGruposComponent:()=>U});var m=o(2200),e=o(9417),h=o(1413),l=o(6977),E=o(5596),O=o(6751),f=o(3746),M=o(3791),C=o(8834),D=o(9183),_=o(1074),d=o(3225),P=o(9947),v=o(4333),r=o(3664),b=o(7705),G=o(3817),g=o(1782),F=o(5416);function A(a,u){1&a&&(r.j41(0,"div",11),r.EFF(1," Nombre es requerido y debe tener m\xe1ximo 50 caracteres. "),r.k0s())}function I(a,u){1&a&&(r.j41(0,"div",11),r.EFF(1," M\xe1ximo 200 caracteres. "),r.k0s())}function T(a,u){1&a&&(r.j41(0,"div"),r.nrm(1,"app-loading-spinner",12),r.k0s())}function R(a,u){if(1&a&&(r.j41(0,"div",11),r.EFF(1),r.k0s()),2&a){const t=r.XpG();r.R7$(),r.JRh(t.error)}}let U=(()=>{class a{fb;grupoService;router;route;snackBar;cdr;grupoForm;procesando=!1;error=null;modoEdicion=!1;idGrupo=null;loading=!1;modosOperacion=[{value:d.q.ESTANDAR,label:"Est\xe1ndar",descripcion:"Distribuci\xf3n b\xe1sica"},{value:d.q.EQUITATIVO,label:"Equitativo",descripcion:"Todos pagan lo mismo"},{value:d.q.PROPORCIONAL,label:"Proporcional",descripcion:"Seg\xfan ingresos"}];destroy$=new h.B;constructor(t,s,n,i,c,k){this.fb=t,this.grupoService=s,this.router=n,this.route=i,this.snackBar=c,this.cdr=k,this.grupoForm=this.fb.group({NombreGrupo:["",[e.k0.required,e.k0.minLength(3),e.k0.maxLength(50)]],Descripcion:["",[e.k0.maxLength(200)]],ModoOperacion:[d.q.ESTANDAR,[e.k0.required]]})}ngOnInit(){this.route.params.pipe((0,l.Q)(this.destroy$)).subscribe(t=>{t.idGrupo&&(this.idGrupo=t.idGrupo,this.modoEdicion=!0,this.cargarGrupo())})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}cargarGrupo(){this.idGrupo&&(this.procesando=!0,this.cdr.markForCheck(),this.grupoService.obtenerGrupo(this.idGrupo).pipe((0,l.Q)(this.destroy$)).subscribe({next:t=>{t.exito&&t.data&&this.grupoForm.patchValue({NombreGrupo:t.data.nombreGrupo,Descripcion:t.data.descripcion,ModoOperacion:t.data.modoOperacion}),this.procesando=!1,this.cdr.markForCheck()},error:t=>{console.error("\u274c Error al cargar grupo:",t),this.error="Error al cargar el grupo",this.procesando=!1,this.cdr.markForCheck()}}))}submit(){if(this.grupoForm.invalid)return void this.grupoForm.markAllAsTouched();this.procesando=!0,this.error=null,this.cdr.markForCheck();const t={nombreGrupo:this.grupoForm.get("NombreGrupo")?.value,descripcion:this.grupoForm.get("Descripcion")?.value,modoOperacion:this.grupoForm.get("ModoOperacion")?.value};console.log("\u{1f527} Datos del grupo:",t),(this.modoEdicion?this.grupoService.actualizarGrupo(this.idGrupo,t):this.grupoService.crearGrupo(t)).pipe((0,l.Q)(this.destroy$)).subscribe({next:n=>{n.exito?(this.snackBar.open(this.modoEdicion?"Grupo actualizado exitosamente":"Grupo creado exitosamente","Cerrar",{duration:3e3}),this.router.navigate(["/grupos"])):this.error=n.mensaje||"Error al procesar la solicitud",this.procesando=!1,this.cdr.markForCheck()},error:n=>{console.error("\u274c Error al procesar grupo:",n),this.error="Error al procesar el grupo. Intente nuevamente.",this.procesando=!1,this.cdr.markForCheck()}})}cancelar(){this.router.navigate(["/grupos"])}get nombreGrupo(){return this.grupoForm.get("NombreGrupo")}get descripcion(){return this.grupoForm.get("Descripcion")}get modoOperacion(){return this.grupoForm.get("ModoOperacion")}static \u0275fac=function(s){return new(s||a)(r.rXU(e.ok),r.rXU(G.b),r.rXU(g.Ix),r.rXU(g.nX),r.rXU(F.UG),r.rXU(b.gRc))};static \u0275cmp=r.VBU({type:a,selectors:[["app-alta-grupos"]],decls:23,vars:6,consts:[["card-header",""],["card-content",""],[3,"ngSubmit","formGroup"],["for","NombreGrupo"],["id","NombreGrupo","formControlName","NombreGrupo","type","text","maxlength","50"],["class","error",4,"ngIf"],["for","Descripcion"],["id","Descripcion","formControlName","Descripcion","maxlength","200"],["type","hidden","formControlName","ModoOperacion"],["type","submit",3,"disabled"],[4,"ngIf"],[1,"error"],["text","Creando grupo..."]],template:function(s,n){if(1&s&&(r.j41(0,"app-card"),r.qex(1,0),r.j41(2,"mat-icon"),r.EFF(3,"group_add"),r.k0s(),r.j41(4,"span"),r.EFF(5,"Alta de Grupo"),r.k0s(),r.bVm(),r.qex(6,1),r.j41(7,"form",2),r.bIt("ngSubmit",function(){return n.submit()}),r.j41(8,"div")(9,"label",3),r.EFF(10,"Nombre del Grupo"),r.k0s(),r.nrm(11,"input",4),r.DNE(12,A,2,0,"div",5),r.k0s(),r.j41(13,"div")(14,"label",6),r.EFF(15,"Descripci\xf3n"),r.k0s(),r.nrm(16,"textarea",7),r.DNE(17,I,2,0,"div",5),r.k0s(),r.nrm(18,"input",8),r.j41(19,"button",9),r.EFF(20,"Crear Grupo"),r.k0s(),r.DNE(21,T,2,0,"div",10)(22,R,2,1,"div",5),r.k0s(),r.bVm(),r.k0s()),2&s){let i,c;r.R7$(7),r.Y8G("formGroup",n.grupoForm),r.R7$(5),r.Y8G("ngIf",(null==(i=n.grupoForm.get("NombreGrupo"))?null:i.touched)&&(null==(i=n.grupoForm.get("NombreGrupo"))?null:i.invalid)),r.R7$(5),r.Y8G("ngIf",(null==(c=n.grupoForm.get("Descripcion"))?null:c.touched)&&(null==(c=n.grupoForm.get("Descripcion"))?null:c.invalid)),r.R7$(2),r.Y8G("disabled",n.loading),r.R7$(2),r.Y8G("ngIf",n.loading),r.R7$(),r.Y8G("ngIf",n.error)}},dependencies:[m.MD,m.bT,e.X1,e.qT,e.me,e.BC,e.cb,e.tU,e.j4,e.JD,E.Hu,O.M,f.fS,M.M,C.Hl,D.D6,_.m_,_.An,P.i,v.N],styles:['@charset "UTF-8";.alta-grupo-container[_ngcontent-%COMP%]{max-width:400px;margin:2rem auto;padding:2rem;background:#fff;border-radius:8px;box-shadow:0 0 10px #0001}form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.2rem;font-weight:700}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:.4rem;border:1px solid #ccc;border-radius:4px}button[_ngcontent-%COMP%]{padding:.5rem 1.2rem;background:#1976d2;color:#fff;border:none;border-radius:4px;cursor:pointer}button[disabled][_ngcontent-%COMP%]{background:#ccc;cursor:not-allowed}.error[_ngcontent-%COMP%]{color:#e53935;font-size:.9em;margin-top:.2rem}[_nghost-%COMP%]{contain:layout style paint;display:block}.dashboard-container[_ngcontent-%COMP%], .stats-container[_ngcontent-%COMP%], .actions-grid[_ngcontent-%COMP%], .timeline-list[_ngcontent-%COMP%]{transform:translateZ(0);will-change:transform}mat-card[_ngcontent-%COMP%]{backface-visibility:hidden}.dashboard-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}'],changeDetection:0})}return a})()}}]);